registerNameSpace("Search");var filterSelectedLogging={},upaDataHf={},odc;
Search.Orchestrator=function(a,m){function q(){amplify.subscribe("scrollToTop",function(){a("html, body").scrollTop(0)});amplify.subscribe("refreshUrlHash",function(a){n(a)});amplify.subscribe("removeUrlHash",function(){window.location.href=window.location.href.split("#")[0]});amplify.subscribe("reloadPage",function(b){b=b||1;amplify.publish("checkPriceFilterInput");b="orderCriteria="+a("#orderBy").val()+"&page="+b+"&"+a("#filtersForm").serialize();var f=[location.protocol,"//",location.host,location.pathname].join("");
amplify.publish("checkPriceFilterInput");window.location.href=f+"?"+b});amplify.subscribe("changeViewGrid",function(){a("#ux-hotels-sorter-popover .popup-close").click();amplify.publish("updateGridListButtons","v4");odc.eventButtonClick(this,"results-grid");amplify.publish("trackABTesting","results-grid");if(b.dateSearch){var e=Common.Utils.Helper.removeParams(window.location.hash,["hotel-results"]);window.location.hash=e+"&hotel-results=v4"}else a("#hotel-results-version").val("v4"),n(a("#pageNumber").val())});
amplify.subscribe("changeViewList",function(){a("#ux-hotels-sorter-popover .popup-close").click();amplify.publish("updateGridListButtons","");odc.eventButtonClick(this,"results-list");amplify.publish("trackABTesting","results-list");b.dateSearch?window.location.hash=Common.Utils.Helper.removeParams(window.location.hash,["hotel-results"]):(a("#hotel-results-version").val(b.defaultHotelResultsVersion),n(a("#pageNumber").val()))})}function r(a,b,d){amplify.publish("callLoggerDS4J",a,b,d)}function s(b){var f=
Common.Utils.Cookie.ReadCookie(b);f&&(-1==f.indexOf("hotels-details=new")&&-1==f.indexOf("hotels-details=old")&&-1==f.indexOf("hotels-details=default"))&&a(".cookieData").css("display","block").text(b+" : "+f)}function n(e,f){a("#resultSoldOutDetail").hide();var d=e||1;amplify.publish("checkPriceFilterInput");var c="";if(b.dateSearch){var c=a("#latitude1").val(),g=a("#longitude1").val(),h=a("#latitude2").val(),k=a("#longitude2").val(),l=a("#place-search input").val();c&&g&&h&&k?window.location.href=
"#latitude1="+c+"&longitude1="+g+"&latitude2="+h+"&longitude2="+k+"&placeSearch="+l+"&orderCriteria="+a("#orderBy").val()+"&page="+d+"&"+a("#filtersForm").serialize():(d="#orderCriteria="+a("#orderBy").val()+"&page="+d+"&"+a("#filtersForm").serialize(),c=a("#fixed-price-range"),c.length?(c=c.find(a("input:checked:visible")),g="&minPrice=",h="&maxPrice=",k=0,c&&(l=c.val().split("-"),k=c.attr("range-order"),g+=l[0],h+=l[1]),d=d+g+h+"&rangeOrder="+k):d.replace("minPrice="+b.priceFromPlaceholder,"minPrice=").replace("maxPrice="+
b.priceToPlaceholder,"maxPrice="),window.location.href=d)}else c=globals.baseUrl+"?orderCriteria="+a("#orderBy").val()+"&page="+d+"&"+a("#filtersForm").serialize(),c=c.replace("minPrice="+b.priceFromPlaceholder,"minPrice=").replace("maxPrice="+b.priceToPlaceholder,"maxPrice="),globals.standard!==m&&(c+="&standard="+globals.standard),amplify.publish("getResults",c,p);amplify.publish("checkPriceFilterInput");a("h1 .titleResults").html(b.resources.hotelsIn)}function t(){$searchbox=a(".searchbox");$searchbox.find(".ctn-searchbutton").on({click:function(){a(".searchbox .mod-no-dates input").is(":checked")?
amplify.publish("trackABTesting","NO-DATES-SEARCH-SELECTED"):amplify.publish("trackABTesting","SEARCH-WITH-DATES-DEFINED")}})}var u={quantityPassengers:1,notNumericErrorMsg:"",invalidPriceFromErrorMsg:"",errorMessage:"",distanceSortMsg:"",defaultHotSpotFilterValue:null,defaultOrderByFilterValue:null,priceFromPlaceholder:"",priceToPlaceholder:"",getHsmResults:!0,userAction:"default",baseLoggerDS4JUrl:"",standard:!0,discountTicket:{hotelId:0},resources:{hotelFoundIn:"",hotelsFoundIn:"",hotelAvailableIn:"",
hotelsAvailableIn:"",maxCapacity:"",seeMoreRooms:"",seeFewerRooms:"",people:"",person:"",additionalBeds:"",additionalBed:""},showPopupRedirect:!1},b={},p=!1;return{init:function(e){logger.info("Inicializando Search Orchestrator");odc=new Common.OmnitureDataCollector;b=a.extend({},u,e);_carrousel={baseUrl:b.photosBaseUrl,serviceUrl:b.photosServiceUrl,carrouselConfig:b.carrouselConfig,hotelResultsVersion:b.hotelResultsVersion};e=a.extend(b,{target:".mySearchedHotelsContainer",section:"landing",language:b.language,
country:b.country,lengthName:11});upaDataHf.fl=b.dateSearch?"search":"landing:results";e=new myRecentSearch(e);Search.Modules.Results.ViewedHotels.init(b,e);b.showPopupRedirect&&Commons.Common.PopupRedirect.init({language:b.language,elemToShowPopup:a(".ux-common-grid-col9")});Search.Modules.ManualCarrousel.init(_carrousel);Search.Modules.Order.init(b);Search.Modules.Filters.init(b);Search.Modules.Reviews.init(b);deuhcducdub();!b.dateSearch&&globals.renderByAjax&&Search.Modules.SeoInfo.SeoInfo.init(b);
Search.Modules.Results.init({generalSettings:b});Search.Utils.Tracker.init(b.baseLoggerDS4JUrl,b.dateSearch,b.popunderFlow);b.dateSearch?Search.Modules.Pagination.init(b):(Search.Modules.PaginationLandings.init(b),Search.Utils.SearchBox.init(b));q();b.dateSearch&&r(Search.Utils.Helper.dateFormatter(),"","start");s("X-Version-Override");b.getHsmResults?(a(window).bind("hashchange",function(a){b.dateSearch&&amplify.publish("getResults",ResultsHelper.generateAjaxUrl(!1,b.userAction),p)}),b.dateSearch||
amplify.publish("setUpResults",b.landingsInfo),p=!0,a("html, body").scrollTop(0),a("#betterPriceLink").click(function(){var b=a("#best-price-popup");if(!b.length){var d=a(this).css({position:"relative",overflow:"visible"}),b=a(".nibbler-popup-best-price").clone().prop("id","best-price-popup").appendTo(d).css({position:"absolute",top:"40px",right:"0",left:"auto"});b.find(".exit").on("click",function(a){a.stopImmediatePropagation();b.fadeOut()})}b.fadeIn()}),a(".mapResult .filterList").hover(function(){a(".mapLinkContainer").addClass("activeLinkMapContainer")},
function(){a(".mapLinkContainer").removeClass("activeLinkMapContainer")}),a("#popup-redirect .popup-close").click(function(){$this=a(this);$this.parent().hide()}),Search.Utils.Helper.addPopunderLink(".otherLinks"),t()):a("#hotelNotExist").show()},showErrors:function(){a(".search-loader").hide();a("#filterAndWrongDatesError").show();a("#paginator").hide();a("#resultsPerPage").hide();a("#hotelTopFilters").hide();a("#hotelResults").hide();a("#currencyTopHeader").hide()}}}(jQuery);
function logFilterSelected(a,m){filterSelectedLogging[a]=m};
